<?/*Шаблон генератора кнопки========================*/?><?# Подключение шапки админкиinclude_once dirname(__FILE__) . '/../design/adminHeader.tpl.php';?>	<br>    <div class="container-fluid">			<ul class="breadcrumb">			<li>				<a title="Вернуться к началу" href="index.php"><i class="icon-home"></i>&nbsp;Админ.интерфейс</a>				<span class="divider">/</span>				</li>			<li class="active">				<a href="codegen.php">Генератор кнопки заказа</a>			</li>		</ul>			<h3>1. Введите параметры товара, которые считаете нужными</h3>				<br>				<form action="" class="form-horizontal" method="post" enctype="multipart/form-data">		<div class="row-fluid">		<div class="span6">					<div class="control-group">				<label class="control-label" for="code">Код товара</label>				<div class="controls">					<input type="text" name="code" class="input-large tip" value="<?= (!empty($product['code'])) ? $product['code'] : '' ?>"					data-content="Обязательный параметр. Должен быть уникален."  data-original-title="Идентификатор товара"					>				</div>			</div>						<div class="control-group">				<label class="control-label" for="title">Название</label>				<div class="controls">					<input type="text" name="title" class="input-large tip" value="<?= (!empty($product['title'])) ? $product['title'] : '' ?>"					data-content="Обязательный параметр. Не используйте спец.символов."  data-original-title="Наименование товара"					>				</div>			</div>						<div class="control-group">				<label class="control-label" for="pruce">Цена</label>				<div class="controls">					<input type="text" name="price" class="input-mini tip" value="<?= (!empty($product['price'])) ? $product['price'] : '' ?>" data-content="Обязательный параметр. С точкой или запятой."  data-original-title="Цена товара"> <?= $config['currency'] ?>				</div>			</div>						<div class="control-group">				<label class="control-label" for="discount">Скидка</label>				<div class="controls">					<input type="text" name="discount" class="input-mini tip" value="<?= (!empty($product['discount'])) ? $product['discount'] : '' ?>" data-content="Эта кнопка будет иметь указанный процент скидки."  data-original-title="Скидка на товар"> %				</div>			</div>			<div class="control-group">				<label class="control-label" for="unit">Единица измерения</label>				<div class="controls">					<input type="text" name="unit" class="input-mini tip" value="<?= (!empty($product['unit'])) ? $product['unit'] : '' ?>" data-content="Например: шт., л., г., кг., т., м., м. кв., уп., ящ."  data-original-title="В чём измеряется товар">				</div>			</div>						<? if (isset($product['store'])): ?>			<div class="control-group">				<label class="control-label" for="store">Остаток на складе</label>				<div class="controls">					<input type="text" name="store" class="input-mini tip" value="<?= (!empty($product['store'])) ? $product['store'] : '0' ?>" data-content="Количество товара у вас на складе"  data-original-title="Товар в наличии">				</div>			</div>			<? endif;?>						<hr/>						<? if ($config['deadlines']['enabled'] === true && !empty($config['deadline'])): ?>			<div class="control-group">				<label class="control-label" for="deadline">Дедлайн</label>				<div class="controls">					<div class="input-prepend hover_tip" data-content="Вы можете задать дедлайн для товара."  data-original-title="Дедлайн">						<span class="add-on"><i class="icon-th-list"></i></span><select name="deadline" class="input-medium">							<option value="">без дедлайна</option>							<? if ($config['deadlines']['unique_link'] === true): ?>								<? foreach ($config['deadline'] as $param => $deadline): ?>								<? if ($param != 'mass'): ?>								<option value="<?= $param ?>" <?= (isset($_GET['deadline']) && $_GET['deadline'] == $param) ? 'selected="selected"' : ''?>><?= $deadline['title'] ?></option>								<? endif; ?>								<? endforeach; ?>							<? else: ?>								<option value="mass" <?= (isset($_GET['deadline']) && $_GET['deadline'] == 'mass') ? 'selected="selected"' : ''?>>Для всех</option>							<? endif; ?>						</select>					</div>				</div>			</div>			<? else: ?>				<input type="hidden" name="deadline" value="">			<? endif; ?>						<? if ($config['bonuses']['enabled'] === true && !empty($config['bonus'])): ?>			<div class="control-group">				<label class="control-label" for="bonus">Бонус</label>				<div class="controls">					<div class="input-prepend hover_tip" data-content="Вы можете задать бонус для товара."  data-original-title="Дедлайн">						<span class="add-on"><i class="icon-th-list"></i></span><select name="bonus" class="input-medium">							<option value="">без бонуса</option>							<? foreach ($config['bonus'] as $param => $bonus): ?>							<option value="<?= $param ?>" <?= (isset($_GET['bonus']) && $_GET['bonus'] == $param) ? 'selected="selected"' : ''?>><?= $bonus['title'] ?></option>							<? endforeach; ?>						</select>					</div>				</div>			</div>			<? else: ?>				<input type="hidden" name="bonus" value="">			<? endif; ?>						<? if ($config['upsells']['enabled'] === true && !empty($config['upsell'])): ?>			<div class="control-group">				<label class="control-label" for="upsell">Апсел</label>				<div class="controls">					<div class="input-prepend hover_tip" data-content="Вы можете задать апсел для товара."  data-original-title="Дедлайн">						<span class="add-on"><i class="icon-th-list"></i></span><select name="upsell" class="input-medium">							<option value="">без апсела</option>							<? foreach ($config['upsell'] as $param => $upsell): ?>							<option value="<?= $param ?>" <?= (isset($_GET['upsell']) && $_GET['upsell'] == $param) ? 'selected="selected"' : ''?>><?= $upsell['title'] ?></option>							<? endforeach; ?>						</select>					</div>				</div>			</div>			<? else: ?>				<input type="hidden" name="upsell" value="">			<? endif; ?>						<? if ($config['bandles']['enabled'] === true): ?>			<hr/>			<h4>Товары комплекта</h4>			<? $products_in_db = $mDB->GetAllItems('product'); ?>			<? if (isset($product['bandle_products'])) $bandle_products = explode('|', $product['bandle_products']); ?>			<? for ($x = 0; $x < $config['bandles']['products']; $x++): ?>				<div class="control-group">					<label class="control-label">Товар <?= $x + 1 ?></label>					<div class="controls">						<div class="input-prepend hover_tip" data-content="Вы можете задать товары в комплект."  data-original-title="Товар">							<span class="add-on"><i class="icon-th-list"></i></span><select name="bandle_product_<?=$x?>" class="input-medium">								<option value="">без товара</option>								<? foreach ($products_in_db as $key => $product_in_db): ?>								<option value="<?= $product_in_db['code'] ?>" <?= (isset($bandle_products[$x]) && $product_in_db['code'] == $bandle_products[$x]) ? 'selected="selected"' : ''?>><?= $product_in_db['title'] ?></option>								<? endforeach; ?>							</select>						</div>					</div>				</div>			<? endfor; ?>			<? endif; ?>		</div>		<div class="span6">			<? if ($config['params']['enabled'] === true): ?>				<? if (isset($_GET['id_product'])): ?>				<h4>Параметры:</h4>				<? if (isset($product_params) && !empty($product_params)):?>									<? foreach ($product_params as $key_param => $product_param): ?>					<div class="control-group">						<label class="control-label"><?= $product_param['title'] ?></label>						<div class="controls">							<? foreach ($product_param['items'] as $key => $item): ?>							<input type="text" name="item_title_<?= $key_param ?>[<?= $item['id_param_item'] ?>]" class="input-medium" value="<?= $item['title'] ?>">							<input type="text" name="item_price_<?= $key_param ?>[<?= $item['id_param_item'] ?>]" class="input-mini" value="<?= $item['price'] ?>">							<a href="<?= $config['sitelink'] . $config['dir'] . 'admin/codegen.php?id_product=' . $_GET['id_product'] ?>&remove_param_item=<?= $item['id_param_item'] ?>" class="btn btn-mini btn-danger" onclick="return confirm('Вы действительно хотите удалить вариант?')"><i class="icon-remove icon-white"></i></a>							<? if ($config['params']['enabled'] === true): ?>								<? if (is_file(dirname(__FILE__) . '/../' . $config['download']['dir'] . '/' . $config['params']['upload']['dir'] . '/' . $item['id_param_item'] . '.' . $config['params']['upload']['type'])): ?>								<a href="<?= $config['sitelink'] . $config['dir'] ?>admin/codegen.php?download_file=<?= $item['id_param_item'] ?>.<?= $config['params']['upload']['type'] ?>&dir=<?= $config['params']['upload']['dir'] ?>">Скачать</a> <a href="<?= $config['sitelink'] . $config['dir'] ?>admin/codegen.php?delete_file=<?= $item['id_param_item'] ?>.<?= $config['params']['upload']['type'] ?>&dir=<?= $config['params']['upload']['dir'] ?>" title="Удалить файл" class="delete" onclick="return confirm('Вы действительно хотите удалить файл?')">Удалить</a><br>								<? else: ?>								<? endif; ?>								<input type="file" accept="<?=$config['params']['upload']['mime']?>" name="item_file[<?= $item['id_param_item'] ?>]" class="input-mini">							<? endif; ?>							<br/>							<? endforeach; ?>							<br>							<select name="param_sort_<?= $key_param ?>" class="input-mini">								<? for ($i = 1; $i <= count($product_params); $i++): ?>								<option value="<?= $i ?>" <?= ($i == $product_param['sort']) ? 'selected="selected"' : '' ?>><?= $i ?></option>								<? endfor; ?>							</select>							<select name="param_type_<?= $key_param ?>" class="input-small">								<option value="radio" <?= ('radio' == $product_param['type']) ? 'selected="selected"' : '' ?>>Выбор</option>								<option value="flags" <?= ('flags' == $product_param['type']) ? 'selected="selected"' : '' ?>>Флажки</option>								<option value="checkbox" <?= ('checkbox' == $product_param['type']) ? 'selected="selected"' : '' ?>>Вкл/выкл</option>							</select>							<select name="param_parent_<?= $key_param ?>" class="input-small">								<option value="" <?= (empty($product_param['parent'])) ? 'selected="selected"' : '' ?>>Нет родителя</option>								<? foreach ($product_params as $tmp_key_param => $tmp_product_param): ?>									<? if ($tmp_product_param['type'] == 'checkbox'): ?>									<option value="<?=$tmp_key_param?>" <?= ($tmp_key_param == $product_param['parent']) ? 'selected="selected"' : '' ?>><?=$tmp_product_param['title']?></option>									<? endif; ?>								<? endforeach; ?>							</select>							<select name="param_required_<?= $key_param ?>" class="input-medium">								<option value="0" <?= (0 == $product_param['required']) ? 'selected="selected"' : '' ?>>Не обязательный</option>								<option value="1" <?= (1 == $product_param['required']) ? 'selected="selected"' : '' ?>>Oбязательный</option>							</select>							<br/>							<button name="edit_param" value="<?= $key_param ?>" class="btn btn-mini btn-success">Сохранить <i class="icon-ok icon-white"></i></button>							<button name="add_param" value="<?= $key_param ?>" class="btn btn-mini btn-primary">Добавить <i class="icon-plus icon-white"></i></button>							<button name="delete_param" value="<?= $key_param ?>" class="btn btn-mini btn-danger" onclick="return confirm('Вы действительно хотите удалить параметр?')">Удалить <i class="icon-remove icon-white"></i></button>						</div>					</div>					<? endforeach; ?>				<? endif; ?>				<div class="control-group">					<h4>Добавить параметр</h4>					<div>						<input type="text" name="new_param_title" class="input-medium" value="" placeholder="Название параметра">						<input type="text" name="new_param_name" class="input-small" value="" placeholder="ID параметра">						<select name="new_param_type" class="input-small">							<option value="radio">Выбор</option>							<option value="flags">Флажки</option>							<option value="checkbox">Вкл/выкл</option>						</select>						<select name="new_param_parent" class="input-small">							<option value="">Нет родителя</option>							<? if (isset($product_params) && !empty($product_params)): ?>							<? foreach ($product_params as $key_param => $product_param): ?>								<? if ($product_param['type'] == 'checkbox'): ?>								<option value="<?=$key_param?>"><?=$product_param['title']?></option>								<? endif; ?>							<? endforeach; ?>							<? endif; ?>						</select>						<select name="new_param_required" class="input-medium">							<option value="0">Не обязательный</option>							<option value="1">Oбязательный</option>						</select>						<button name="add_new_param" class="btn btn-primary">Добавить <i class="icon-plus icon-white"></i></button>					</div>				</div>				<hr/>				<? endif; ?>			<? endif; ?>						<div class="control-group">				<label class="control-label" for="qty">Количество товара</label>				<div class="controls">					<input type="text" name="qty" class="input-mini tip" value="<?= (!empty($product['qty'])) ? $product['qty'] : '' ?>"					data-content="Вы можете задать количество товара в заказе по умолчанию" data-original-title="Количество товара">				</div>			</div>			<div class="control-group">				<label class="control-label" for="qty_type">Выбор количества</label>				<div class="controls">					<div class="input-prepend hover_tip" data-content="Вы можете разрешить покупателю изменять количество товара в заказе. При выборе «Не важно» будет взято значение по умолчанию."  data-original-title="Выбор количества товара">						<span class="add-on"><i class="icon-check"></i></span><select name="qty_type" class="input-medium">							<option value="" <? if (isset($product['qty_type']) && $product['qty_type'] == ''): ?>selected="selected"<? endif ?>>не важно</option>							<option value="text" <? if (isset($product['qty_type']) && $product['qty_type'] == 'text'): ?>selected="selected"<? endif ?>>да</option>							<option value="no" <? if (isset($product['qty_type']) && $product['qty_type'] != 'text' && $product['qty_type'] != ''): ?>selected="selected"<? endif ?>>нет</option>						</select>					</div>				</div>			</div>						<div class="control-group">				<label class="control-label" for="param1">Параметр 1</label>				<div class="controls">					<input type="text" name="param1" class="input-large tip" value="<?= (!empty($product['param1'])) ? $product['param1'] : '' ?>" data-content="Вы можете поместить сюда любые данные" data-original-title="Дополнительный параметр">				</div>			</div>						<div class="control-group">				<label class="control-label" for="param2">Параметр 2</label>				<div class="controls">					<input type="text" name="param2" class="input-large tip" value="<?= (!empty($product['param2'])) ? $product['param2'] : '' ?>" data-content="Вы можете поместить сюда любые данные" data-original-title="Дополнительный параметр">				</div>			</div>						<div class="control-group">				<label class="control-label" for="param3">Параметр 3</label>				<div class="controls">					<input type="text" name="param3" class="input-large tip" value="<?= (!empty($product['param3'])) ? $product['param3'] : '' ?>" data-content="Вы можете поместить сюда любые данные" data-original-title="Дополнительный параметр">				</div>			</div>			<hr/>						<div class="control-group">				<label class="control-label" for="form_type">Форма вывода</label>				<div class="controls">					<div class="input-prepend hover_tip" data-content="Вы можете задать форму вывода. При выборе «Не важно» будет взято значение по умолчанию."  data-original-title="Форма вывода">						<span class="add-on"><i class="icon-th-list"></i></span><select name="form_type" class="input-medium">							<option value="">не важно</option>							<? foreach ($config['form_types'] as $type => $form_type): ?>							<option value="<?= $type ?>" <?= (!empty($product['form_type']) && $type == $product['form_type']) ? 'selected="selected"' : ''?>><?= $form_type ?></option>							<? endforeach; ?>						</select>					</div>				</div>			</div>			<div class="control-group" id="button_img" <?= (!empty($product['form_type']) && $product['form_type'] == 'button_img') ? '' : 'style="display:none"' ?>>				<label class="control-label" for="button_img">Изображение кнопки</label>				<div class="controls">					<input type="text" name="button_img" class="input-large tip" value="<?= (!empty($product['button_img'])) ? $product['button_img'] : ''?>" data-content="Вы можете задать адрес изображения кнопки" data-original-title="Изображение кнопки">				</div>			</div>		</div>		</div>		<br/>		<? if (is_file(dirname(__FILE__) . '/../admin/products.php')):?>			<h3>2. Нажмите кнопку</h3>			<p>				<input type="hidden" name="id_product" value="<?= (isset($_GET['id_product'])) ? $_GET['id_product'] : '' ?>">				<input type="hidden" name="params" value='<?= (isset($product['params'])) ? $product['params'] : '' ?>'>				<button type="submit" name="save" class="btn btn-success">Сохранить товар</button>			</p>			<h3>3. Скопируйте код и вставьте его на страницу</h3>			<p>				<textarea id="string2" rows="1" style="width: 100%;"><? if (isset($_GET['id_product'])): ?>&lt;script type="text/javascript" src="<?= $config['sitelink'] . $config['dir'] ?>JS.php?product=<?= $product['code']?><? if (isset($product['form_type']) && $product['form_type'] != ''): ?>&form_type=<?= $product['form_type'] ?><? endif; ?><? if (isset($product['button_img']) && $product['button_img'] != ''): ?>&button_img=<?= $product['button_img'] ?><? endif; ?><? if (isset($_GET['bonus']) && $_GET['bonus'] != ''): ?>&bonus=<?= $_GET['bonus'] ?><? endif; ?><? if (isset($_GET['upsell']) && $_GET['upsell'] != ''): ?>&upsell=<?= $_GET['upsell'] ?><? endif; ?><? if (isset($_GET['deadline']) && $_GET['deadline'] != ''): ?>&deadline=<?= $_GET['deadline'] ?><? endif; ?>"></script><? endif; ?></textarea>			</p>			<? if (isset($_GET['id_product'])): ?>			<p>				<button type="submit" name="clean" class="btn btn-danger">Очистить форму</button>			</p>			<? endif ?>		<? else: ?>			<h3>2. Нажмите кнопку</h3>			<p>				<input type="hidden" name="sitelink" value="<?= $config['sitelink'] ?>">				<input type="hidden" name="dir" value="<?= $config['dir'] ?>">				<button type="submit" name="submit" class="btn btn-primary">Генерировать код</button>			</p>						<br/>						<h3>3. Скопируйте код и вставьте его на страницу</h3>			<p>				<textarea id="string" rows="1" style="width: 100%;"></textarea>			</p>		<? endif ?>		</form>    </div>		<script type="text/javascript">	var sitelink = $('input[name="sitelink"]').val();	var dir = $('input[name="dir"]').val();	var script = '<' + 'script type="text/javascript" src="' + sitelink + dir + 'JS.php">' + '<' + '/script>';	$('#string').val(script);		$('button[name="submit"]').click(function(){		var sitelink = $('input[name="sitelink"]').val();						var code = $('input[name="code"]').val();		var title = $('input[name="title"]').val();		var price = $('input[name="price"]').val();		var discount = $('input[name="discount"]').val();		var qty = $('input[name="qty"]').val();		var qty_type = $('select[name="qty_type"]').val();		var unit = $('input[name="unit"]').val();		var param1 = $('input[name="param1"]').val();		var param2 = $('input[name="param2"]').val();		var param3 = $('input[name="param3"]').val();				var deadline = $('[name="deadline"]').val();		var upsell = $('[name="upsell"]').val();		var bonus = $('[name="bonus"]').val();				var form_type = $('select[name="form_type"]').val();		var button_img = $('input[name="button_img"]').val();				var params = {'code':code, 'title':title, 'price':price, 'discount':discount, 'qty':qty, 'qty_type':qty_type, 'unit':unit, 'param1':param1, 'param2':param2, 'param3':param3, 'form_type':form_type, 'button_img':button_img, 'upsell':upsell, 'bonus':bonus, 'deadline':deadline};			if (code || title || price || discount || qty || qty_type || unit || param1 || param2 || param3 || form_type || button_img || bonus || upsell || deadline) {			var get = '?';			for (var key in params) {				if (params[key] != '') {					get = get + key + '=' + params[key] + '&';				}			}						get = get.slice(0, -1);		}		else {			var get = '';		}				var script = '<' + 'script type="text/javascript" src="' + sitelink + dir + 'JS.php' + get + '">' + '<' + '/script>';					$('#string').val(script);		return false;	});		$('.tip').popover({		'placement' : 'right',		'trigger' : 'focus',		'title' : 'Подсказка',		'content' : 'Заполняйте внимательно'	});		$('.hover_tip').popover({		'placement' : 'right',		'trigger' : 'hover',		'title' : 'Подсказка',		'content' : 'Заполняйте внимательно'	});		$('[name="form_type"]').change(function(){		if ($(this).val() == 'button_img') {			$('#button_img').slideDown('fast');		}		else {			$('#button_img').slideUp('fast');			$('[name="button_img"]').val('');		}	});	</script>	<? if (isset($message)): ?>	<div class="alert alert-error"><?= $message ?></div>	<? endif ?></body></html>